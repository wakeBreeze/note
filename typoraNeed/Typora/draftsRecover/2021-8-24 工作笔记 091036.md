#### 工作资料

svn：zhouxu/ZHOUXU19990101



#### service层执行并获取序列

```java
//导入mapper
@Resource
private DrgBaseMapper drgBaseMapper;

//执行并获取序列
String se_aaz107 = drgBaseMapper.executeForSequence("se_aaz107");
```



#### oracle序列

```sql
-- 银海序列规范
create sequence SE_AAZ6 
minvalue 3213000000000001 
MAXVALUE 3213999999999999 
START with 3213000000000001 
INCREMENT by 1 CACHE 20;

--查看当前用户的所有序列

select SEQUENCE_OWNER,SEQUENCE_NAME from dba_sequences where sequence_owner='用户名';

-- 查询序列的下一个值
select se_aaz609.Nextval from dual;

-- 查询所有序列
select * from user_sequences;

-- 模糊查询序列
select * from user_sequences
where sequence_name like '%AAZ107';


--创建示例表 --
create table Student(
    stuId number(9) not null,
    stuName varchar2(20) not null,
    stuMsg varchar2(50) null
)
  
  -- 创建序列  Student_stuId_Seq --
 create sequence Student_stuId_Seq
 increment by 1
 start with 1
 minvalue 1
 maxvalue 999999999;
 
 -- 更改序列  Student_stuId_Seq--
 alter sequence Student_stuId_Seq
    increment by 2  
    minvalue 1
    maxvalue 999999999;
 
 --获取序列自增ID --
 select Student_stuId_Seq.Nextval 自增序列ID from dual;
 
 -- 删除序列 -- 
 drop sequence Student_stuId_Seq;
 
 --调用序列，插入Student数据 --
 insert into Student(stuId,Stuname) values(Student_stuId_Seq.Nextval,'张三');
 insert into Student(stuId,Stuname) values(Student_stuId_Seq.Nextval,'李四');
 --查询插入的数据 --
 select * from Student
```



#### 查询特定端口占用

```
-- 查看特定端口
netstat -ano |findstr "端口号"

-- 通过进程id查找对应的进程名称
tasklist |findstr "进程id号"

-- 杀掉进程
taskkill /f /t /im "进程id或者进程名称"
```



#### Oracle导入导出

导出表结构及数据

```linux
堡垒机上，到Xshell中10.72.65.247:22数据库服务器上执行导出命令
如：导出kb01表
expdp drgsplatform_sq/drgsplatform_sq@127.0.0.1:1521/pdbcrl directory=dpdata dumpfile=kb01_20210823.dmp tables=kb01 compression=all version=11.2.0.1.0

注：
compression是压缩命令，如果表数据不多的话可以不加compression=all命令。
导出文件默认存放位置是/dbase/orcldump
```



Oracle导入dmp通过dpdata(虚拟路径映射)

```linux
impdp drgsplatform_sq/drgsplatform_sq@127.0.0.1/pdbcrl  directory=dpdata dumpfile=drgsplatform.dmp 
-- directory是虚拟路径映射不用更改
-- 更改dumpfile的文件名
--dmp文件存放在/dbase/orcldump
```

